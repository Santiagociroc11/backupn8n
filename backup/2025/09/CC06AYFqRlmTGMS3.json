{
  "active": false,
  "connections": {
    "Search Contacts": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "Search Contacts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "Replace Me",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking â€˜Execute workflowâ€™": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-09-01T20:31:27.430Z",
  "id": "CC06AYFqRlmTGMS3",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "MASIVO CHATWOOT DESDE EXCEL",
  "nodes": [
    {
      "parameters": {
        "resource": "Contacts",
        "operation": "Contact Search",
        "account_id": 4,
        "q": "={{ $json.numero }}",
        "sort": "last_activity_at",
        "requestOptions": {}
      },
      "type": "@devlikeapro/n8n-nodes-chatwoot.chatWoot",
      "typeVersion": 1,
      "position": [
        -496,
        -208
      ],
      "id": "77db92a8-573e-4200-be40-c0d0a15fea5a",
      "name": "Search Contacts",
      "credentials": {
        "chatwootApi": {
          "id": "UiII573FY6VGrJfJ",
          "name": "CHATWOOT API"
        }
      }
    },
    {
      "parameters": {
        "url": "=https://chatwoot.automscc.com/api/v1/accounts/4/contacts/{{ $json.payload[0].id }}/conversations",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "chatwootApi",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -272,
        -208
      ],
      "id": "a72d931e-b2ee-464a-bb5b-19df576813e1",
      "name": "HTTP Request",
      "credentials": {
        "chatwootApi": {
          "id": "UiII573FY6VGrJfJ",
          "name": "CHATWOOT API"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1o8Sim7TgUiEMh6CDkSoJ7Sbpp8xC0NrXV8ExkEenbk4",
          "mode": "list",
          "cachedResultName": "Hoja de cÃ¡lculo sin tÃ­tulo",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1o8Sim7TgUiEMh6CDkSoJ7Sbpp8xC0NrXV8ExkEenbk4/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Hoja 1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1o8Sim7TgUiEMh6CDkSoJ7Sbpp8xC0NrXV8ExkEenbk4/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -944,
        -128
      ],
      "id": "f9263920-b333-496f-af4c-13fdb2e4261f",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "zruD3ONGC9HU2i7s",
          "name": "CUENTA SANTIAGO"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -720,
        -128
      ],
      "id": "15065697-0fd2-47cd-bd3f-12ad0a5a2cf6",
      "name": "Loop Over Items"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me",
      "typeVersion": 1,
      "position": [
        848,
        -128
      ],
      "id": "753c08ab-55c9-439e-a16d-950f01d1a104"
    },
    {
      "parameters": {
        "jsCode": "// items[0].json viene del nodo HTTP Request\nconst results = [];\n\nfor (const item of items) {\n  const payload = item.json.payload;\n\n  if (Array.isArray(payload) && payload.length > 0) {\n    const conversacion = payload.find(conv => conv.inbox_id === 32);\n\n    if (conversacion) {\n      results.push({ json: conversacion });\n    } else {\n      results.push({ json: { mensaje: \"No se encontrÃ³ conversaciÃ³n en ese inbox\" } });\n    }\n  } else {\n    results.push({ json: { mensaje: \"Sin conversaciones para este contacto\" } });\n  }\n}\n\nreturn results;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -48,
        -208
      ],
      "id": "27d33129-9b3d-41e4-87ae-282248090173",
      "name": "Code"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "38f97431-6e73-4d55-8414-caa29036f805",
              "name": "id",
              "value": "={{ $json.id }}",
              "type": "number"
            },
            {
              "id": "57372949-c486-4239-9876-840a33eab22a",
              "name": "mensaje",
              "value": "=*ALERTA, DISCULPA LA HORA* ðŸ”¥ðŸ”¥\n\nDESDE ESTA TARDE *TUVIMOS PROBLEMAS CON EL NEQUI DEBIDO A TOPES DE LA APP* PARA RECIBIR EL PAGO DE LA PROMOCIÃ“N...\n\nPor lo cual te dejo acÃ¡ abajo EL NEQUI DE RESPALDO:\n\n*NEQUI: 3009937799*\n\n*LOS CUPOS ESTAN AGOTANDOSE*, puedes hacer el pago temprano para asegurar el tuyo ðŸ˜¥",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        176,
        -208
      ],
      "id": "ec8fe43a-d116-43c8-8315-accce987e3e4",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://chatwoot.automscc.com/api/v1/accounts/4/conversations/{{ $json.id }}/messages",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "chatwootApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={ \"content\": {{ $json.mensaje.toJsonString() }},\n  \"message_type\": \"outgoing\"\n      } ",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        400,
        -208
      ],
      "id": "269f60d0-da04-4c9a-a5fa-f9999398f44d",
      "name": "HTTP Request1",
      "credentials": {
        "chatwootApi": {
          "id": "UiII573FY6VGrJfJ",
          "name": "CHATWOOT API"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "amount": 1
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        624,
        -208
      ],
      "id": "0a14fa64-563f-46f9-a020-748a9cc306b6",
      "name": "Wait",
      "webhookId": "58778f77-6337-4cd1-a862-23795fa0f012"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 8 * * *"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -1168,
        -224
      ],
      "id": "f8d638e5-9180-4531-8bbe-1a41ce62c990",
      "name": "Schedule Trigger",
      "disabled": true
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -1168,
        -32
      ],
      "id": "4c045050-c7dc-47b5-a7e0-96bd15c5eea7",
      "name": "When clicking â€˜Execute workflowâ€™"
    }
  ],
  "pinData": {},
  "repo_name": "backupn8n",
  "repo_owner": "Santiagociroc11",
  "repo_path": "backup/",
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "updatedAt": "2025-09-01T20:31:27.435Z",
      "createdAt": "2025-09-01T20:31:27.435Z",
      "role": "workflow:owner",
      "workflowId": "CC06AYFqRlmTGMS3",
      "projectId": "703bt8e3CRxfBTYZ"
    }
  ],
  "staticData": {
    "node:Schedule Trigger": {
      "recurrenceRules": []
    }
  },
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-09-11T02:49:02.000Z",
  "versionId": "eb7ffc5f-7105-4e63-8c7b-ae6e0eccb328"
}